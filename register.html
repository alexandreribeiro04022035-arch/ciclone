<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registrar - CICLONE</title>
<style>
    body { background: #e8edf2; margin: 0; font-family: Arial, sans-serif; }
    .register-box { width: 340px; margin: 60px auto; background: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 0 12px rgba(0,0,0,0.15); }
    h2 { text-align: center; margin-bottom: 25px; }
    input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #b8c2cc; border-radius: 5px; font-size: 15px; }
    button { width: 100%; background: #198754; color: white; padding: 12px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin-top: 10px; }
    button:hover { background: #157347; }
    .link { text-align: center; margin-top: 12px; font-size: 14px; }
    .link a { color: #0d6efd; text-decoration: none; font-weight: bold; }
</style>
</head>
<body>

<div class="register-box">
    <h2>Criar Conta CICLONE</h2>

    <input type="text" id="nome" placeholder="Seu nome">
    <input type="email" id="email" placeholder="Seu e-mail">
    <input type="password" id="senha" placeholder="Crie uma senha">
    <input type="text" id="chavepix" placeholder="Sua chave PIX">
    <input type="text" id="telefone" placeholder="Seu telefone">
    <input type="text" id="avatar" placeholder="URL do seu avatar">

    <button onclick="fazerRegistro()">Registrar</button>

    <div class="link">
        Já possui conta? <a href="login-top.html">Login</a>
    </div>
    
    <p>Ganhe R$ 1.000,00 ou mais</p>
    <p>R$ 0,0001 por click direto no PIX</p>
</div>

<script>
async function fazerRegistro() {
    const nome = document.getElementById('nome').value.trim();
    const email = document.getElementById('email').value.trim();
    const senha = document.getElementById('senha').value.trim();
    const chavepix = document.getElementById('chavepix').value.trim();
    const telefone = document.getElementById('telefone').value.trim();
    const avatar = document.getElementById('avatar').value.trim();

    if (!nome || !email || !senha) {
        alert('Preencha pelo menos nome, email e senha!');
        return;
    }

    try {
        // ✅ URL CORRIGIDA - usando SEU backend real
        const resposta = await fetch('https://ciclone-62mq.onrender.com/api/cadastro', {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({ 
                nome, 
                email, 
                senha, 
                chavepix: chavepix || null, 
                telefone: telefone || null, 
                avatar: avatar || null,
                recebendo_creditos: false,
                limite_atingido: false,
                saldo_redisponivel: 0.00
            })
        });

        // ✅ Verifica se a resposta HTTP é OK
        if (!resposta.ok) {
            throw new Error(`Erro do servidor: ${resposta.status}`);
        }

        const dados = await resposta.json();

        if (dados.success) {
            alert('Conta criada com sucesso!');
            window.location.href = 'login-top.html';
        } else {
            alert('Erro: ' + (dados.error || 'Erro desconhecido'));
        }
    } catch (erro) {
        console.error('Erro completo:', erro);
        alert('Erro de conexão: ' + erro.message);
    }
}
</script>

</body>
</html>
